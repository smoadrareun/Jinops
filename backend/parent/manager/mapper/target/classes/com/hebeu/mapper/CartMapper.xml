<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hebeu.mapper.CartMapper">

    <resultMap id="CartResultMap" type="com.hebeu.model.CartModel">
        <id column="id" jdbcType="VARCHAR" property="id" />
        <result column="cliId" jdbcType="INTEGER" property="cliId" />
        <result column="gooId" jdbcType="INTEGER" property="gooId" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="pic" jdbcType="LONGVARCHAR" property="pic" />
        <result column="specName" jdbcType="VARCHAR" property="specName" />
        <result column="num" jdbcType="INTEGER" property="num" />
        <result column="price" jdbcType="DECIMAL" property="price" />
    </resultMap>

    <select id="selectCartAll" resultMap="CartResultMap">
        SELECT *
        FROM cart
    </select>

    <select id="selectCartById" parameterType="java.lang.String" resultMap="CartResultMap">
        SELECT *
        FROM cart
        WHERE id = #{id,jdbcType=VARCHAR}
    </select>

    <select id="find" parameterType="java.util.Map" resultMap="CartResultMap">
        SELECT *
        FROM cart
        <where>
            <if test="id != null">
                AND id = #{id,jdbcType=VARCHAR}
            </if>
            <if test="cliId != null">
                AND cliId= #{cliId,jdbcType=INTEGER}
            </if>
            <if test="gooId != null">
                AND gooId = #{gooId,jdbcType=INTEGER}
            </if>
            <if test="name != null">
                AND `name` = #{name,jdbcType=VARCHAR}
            </if>
            <if test="pic != null">
                AND pic = #{pic,jdbcType=LONGVARCHAR}
            </if>
            <if test="specName != null">
                AND specName = #{specName,jdbcType=VARCHAR}
            </if>
            <if test="num != null">
                AND num = #{num,jdbcType=INTEGER}
            </if>
            <if test="price != null">
                AND price = #{price,jdbcType=DECIMAL}
            </if>
        </where>
    </select>

    <select id="search" parameterType="java.util.Map" resultMap="CartResultMap">
        SELECT *
        FROM cart
        <where>
            <if test="id != null">
                AND id LIKE CONCAT('%',#{id,jdbcType=VARCHAR},'%')
            </if>
            <if test="cliId != null">
                AND cliId LIKE CONCAT('%',#{cliId,jdbcType=INTEGER},'%')
            </if>
            <if test="gooId != null">
                AND gooId LIKE CONCAT('%',#{gooId,jdbcType=INTEGER},'%')
            </if>
            <if test="name != null">
                AND `name` LIKE CONCAT('%',#{name,jdbcType=VARCHAR},'%')
            </if>
            <if test="pic != null">
                AND pic LIKE CONCAT('%',#{pic,jdbcType=LONGVARCHAR},'%')
            </if>
            <if test="specName != null">
                AND specName LIKE CONCAT('%',#{specName,jdbcType=VARCHAR},'%')
            </if>
            <if test="num != null">
                AND num LIKE CONCAT('%',#{num,jdbcType=INTEGER},'%')
            </if>
            <if test="price != null">
                AND price LIKE CONCAT('%',#{price,jdbcType=DECIMAL},'%')
            </if>
        </where>
    </select>

    <insert id="insert" keyColumn="id" parameterType="java.util.Map" keyProperty="id">
        INSERT INTO cart
            (id, cliId, gooId, `name`, pic, specName, num, price)
        VALUES(#{id,jdbcType=VARCHAR}, #{cliId,jdbcType=INTEGER}, #{gooId,jdbcType=INTEGER},
            #{name,jdbcType=VARCHAR}, #{pic,jdbcType=LONGVARCHAR}, #{specName,jdbcType=VARCHAR},
            #{num,jdbcType=INTEGER}, #{price,jdbcType=DECIMAL})
    </insert>

    <delete id="delete" parameterType="java.lang.String">
        DELETE
        FROM cart
        WHERE id = #{id,jdbcType=VARCHAR}
    </delete>

    <delete id="deleteAddInfo" parameterType="java.lang.Integer">
        DELETE
        FROM addInfo
        WHERE id = #{id,jdbcType=INTEGER}
    </delete>

    <update id="update" keyColumn="id" parameterType="java.util.Map" useGeneratedKeys="true" keyProperty="id">
        UPDATE cart
        <set>
            <if test="cliId != null">
                cliId= #{cliId,jdbcType=INTEGER},
            </if>
            <if test="gooId != null">
                gooId = #{gooId,jdbcType=INTEGER},
            </if>
            <if test="name != null">
                `name` = #{name,jdbcType=VARCHAR},
            </if>
            <if test="pic != null">
                pic = #{pic,jdbcType=LONGVARCHAR},
            </if>
            <if test="specName != null">
                specName = #{specName,jdbcType=VARCHAR},
            </if>
            <if test="num != null">
                num = #{num,jdbcType=INTEGER},
            </if>
            <if test="price != null">
                price = #{price,jdbcType=DECIMAL},
            </if>
        </set>
        WHERE id = #{id,jdbcType=VARCHAR};
    </update>

    <select id="query" parameterType="java.util.Map" resultMap="CartResultMap">
        SELECT *
        FROM cart
        <where>
            <if test="cliId != '' and cliId != null">
                AND cliId = #{cliId,jdbcType=INTEGER}
            </if>
            <if test="sname != '' and sname != null">
                AND `name` LIKE CONCAT('%',#{sname,jdbcType=VARCHAR},'%')
            </if>
            <if test="min != '' and min != null">
                AND price &gt;= #{min,jdbcType=DECIMAL}
            </if>
            <if test="max != '' and max != null">
                AND price &lt;= #{max,jdbcType=DECIMAL}
            </if>
        </where>
        <if test="sort == '1'.toString() ">
            ORDER BY price ASC
        </if>
        <if test="sort == '2'.toString() ">
            ORDER BY price DESC
        </if>
        <if test="page != null and count!='' and count != null">
            LIMIT #{page,jdbcType=INTEGER}, ${count}
        </if>
    </select>
</mapper>